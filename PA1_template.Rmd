---
title: "PA1_template.Rmd"
author: "peter"
date: "Thursday, June 04, 2015"
output: html_document
---
## loading and preprocessing the data


### load data & process/transform data & explore

```{r}
data = read.csv("activity.csv", colClasses=c("integer","Date","integer"))
summary(data)
```

## what is mean total number of steps taken per day?


### calculate the total number of steps taken per day & make a histogram

```{r}
totalSteps<- sapply(split(data$steps,data$date),sum, na.rm=TRUE)
head(totalSteps)
hist(totalSteps, xlab="Number of steps/day", main="Distribution of number of steps taken each day")
```

### calculate (& report) mean and median of the total number of steps taken per day

```{r results="hide"}
mean(totalSteps)
median(totalSteps)
```

The mean of the total number of steps taken per day is `r mean(totalSteps)`.  
The median of the total number of steps taken per day is `r median(totalSteps)`.  

## what is the average daily activity pattern?


###  make a time series plot 

We need to:  
- split data in 5-minute intervals  
- calculate average in each interval  

```{r}
averageInterval<-sapply(split(data$steps,data$interval),mean,na.rm=TRUE)
head(averageInterval)
```

Next, we need to:  
- take the unique intervals for the plot  
- plot and assign labels to the axes  

```{r}
intervals<- unique(data$interval)
plot(x=intervals,y=averageInterval,type='l', main="average number of steps taken, averaged across all days", xlab='intervals (5 minutes)',ylab='number of steps average')
```

### calculate 5-minute interval that, on average across all the days in the dataset, contains the maximum number of steps

We need to:  
- split data in 5-minute intervals  
- calculate sum in each interval  
- find the index of interval with max steps
- 
```{r}
totalInterval<-sapply(split(data$steps,data$interval),sum,na.rm=TRUE)
totalInterval
which.max(totalInterval)
#maxInterval <- intervals[temp]
```
